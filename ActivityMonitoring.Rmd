---
title: "Activity Monitoring"
author: "Claudio"
date: "21/07/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading and preprocessing the data

We stop the process if the csv file is not in the working directory.  
Storing data into a data frame, without addressing NA's
Storing data without NA in another data frame

```{r read}
file <- "activity.csv"
  
if (!file.exists(file)) {
        stop("activity.csv file not found")
}

activity <- read.csv(file)
NoNAActivity <- subset(activity, is.na(activity$steps) == F)
```

# What is mean total number of steps taken per day?

## Calculating the total number of steps taken each day
```{r totalsteps}
library(plyr)
stepsPerDay <- ddply(NoNAActivity, .(date), summarise, steps=sum(steps))
```

## Creating the histogram
```{r histogramsteps}
hist(stepsPerDay$steps, breaks = 20, main="Number of Steps a day", xlab="Total number of steps taken each day", ylab = "Number of Days", col="cyan")
```

## Calculate and report the mean and median total number of steps taken per day
1. Mean
```{r Mean}
mean(stepsPerDay$steps)
```

2. Median
```{r Median}
median(stepsPerDay$steps)
```

# What is the average daily activity pattern?

## 1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

Computing the average number of steps taken in each 5-minutes intervals

```{r Average}
averageInterval <- ddply(NoNAActivity, .(interval), summarise, steps=mean(steps))
```

Creating the plot

```{r Plot}
plot(averageInterval$interval, averageInterval$steps,axes = F, type="l", col="blue", xlab="Time", ylab="Average Number of Steps", main="Average Daily Activity Pattern")
axis(1,at=c(0,600,1200,1800,2400), label = c("0:00","6:00","12:00","18:00","24:00"))
axis(2)
```

## 2. Which 5-minutes interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r WhichMax}
averageInterval[which.max(averageInterval$steps),]
```

And the winner is ... : interval from 8:35 to 8:40

